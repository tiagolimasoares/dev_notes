<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questões de Fixação - Aula 09: Liberdade de Expressão</title>
    <!-- Importação da biblioteca de gráficos Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- 
        DOCUMENTAÇÃO: CSS INCORPORADO
        -----------------------------
        O estilo da página segue um padrão profissional e responsivo, garantindo uma boa experiência 
        tanto em desktops quanto em dispositivos móveis. As justificativas suportam um conteúdo
        mais rico, com parágrafos, listas e ênfases visuais.
    -->
    <style>
        /* Paleta de Cores:
           - Azul Profissional: #3498db
           - Cinza Escuro (Sidebar/Texto): #2c3e50
           - Cinza Claro (Fundo): #f4f7f9
           - Branco: #ffffff
           - Verde (Correto): #2ecc71
           - Vermelho (Incorreto): #e74c3c
        */

        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

        /* Reset e Configurações Globais */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f4f7f9;
            color: #333;
            line-height: 1.6;
        }

        .container {
            display: flex;
            flex-direction: column; /* Adaptação para mobile-first */
            min-height: 100vh;
        }

        /* --- Barra Lateral (Sidebar) --- */
        .sidebar {
            width: 100%; /* Ocupa toda a largura em telas pequenas */
            background-color: #2c3e50;
            color: #ecf0f1;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .sidebar .logo h2 {
            color: #ffffff;
            font-weight: 700;
            text-align: center;
        }

        .sidebar .logo p {
            font-size: 0.9em;
            color: #bdc3c7;
            text-align: center;
        }

        .sidebar .navigation {
            margin-top: 20px;
        }

        .sidebar #progress-container {
            margin-top: 10px;
            background-color: #34495e;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }

        .sidebar #progress-tracker {
            font-size: 1.2em;
            font-weight: 700;
            color: #3498db;
        }

        .sidebar .footer {
            margin-top: 20px;
            font-size: 0.8em;
            text-align: center;
            color: #7f8c8d;
        }

        /* --- Conteúdo Principal --- */
        .main-content {
            flex-grow: 1;
            padding: 20px;
        }

        .quiz-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .quiz-header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.8em;
        }

        /* --- Cartão da Questão --- */
        .question-card {
            background-color: #ffffff;
            border: 1px solid #e0e0e0;
            border-left: 5px solid #3498db;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            transition: box-shadow 0.3s ease;
        }

        .question-card:hover {
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }

        .question-card h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        /* --- Alternativas --- */
        .options {
            list-style: none;
        }

        .options li {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background-color 0.3s, border-color 0.3s;
        }
        
        .options li label {
            flex-grow: 1;
            cursor: pointer;
        }

        .options li:hover {
            background-color: #ecf0f1;
            border-color: #3498db;
        }

        .options input[type="radio"] {
            display: none;
        }

        .options label::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #ccc;
            margin-right: 15px;
            transition: all 0.2s ease;
            vertical-align: middle;
        }

        .options input[type="radio"]:checked + label::before {
            background-color: #3498db;
            border-color: #3498db;
            box-shadow: inset 0 0 0 3px white;
        }

        .eliminate-btn {
            background: none;
            border: none;
            cursor: pointer;
            margin-left: auto;
            padding-left: 10px;
            font-size: 1.2em;
            color: #7f8c8d;
            transition: color 0.3s;
        }

        .eliminate-btn:hover {
            color: #e74c3c;
        }

        .options li.eliminated {
            text-decoration: line-through;
            opacity: 0.5;
            background-color: #fbeaea;
            pointer-events: none;
        }

        /* --- Feedback (Mini-Aula) --- */
        .feedback {
            padding: 20px;
            margin-top: 20px;
            border-radius: 8px;
            display: none;
            border-left-width: 5px;
            border-left-style: solid;
        }

        .feedback.correct {
            background-color: #eafaf1;
            border-left-color: #2ecc71;
            display: block;
        }

        .feedback.incorrect {
            background-color: #fbeaea;
            border-left-color: #e74c3c;
            display: block;
        }
        
        .feedback-title {
            font-weight: 700;
            font-size: 1.2em;
            margin-bottom: 15px;
        }
        .feedback-title.correct-title { color: #27ae60; }
        .feedback-title.incorrect-title { color: #c0392b; }
        
        .feedback-content p {
            margin-bottom: 10px;
        }
        .feedback-content strong {
            color: #2c3e50;
        }
        .feedback-content .example {
            border-left: 3px solid #bdc3c7;
            padding-left: 15px;
            margin: 15px 0;
            font-style: italic;
            color: #555;
        }
        .feedback-content .visual-aid {
            text-align: center;
            font-size: 1.5em;
            margin: 15px 0;
        }
        .feedback-content ul {
            margin-left: 20px;
            margin-bottom: 10px;
        }

        .options li.correct-answer {
            background-color: #eafaf1;
            border-color: #2ecc71;
            font-weight: bold;
        }

        .options li.incorrect-selection {
            background-color: #fbeaea;
            border-color: #e74c3c;
        }

        /* --- Seção de Resultados --- */
        #submit-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 20px;
        }

        #submit-btn:hover {
            background-color: #27ae60;
        }

        .hidden {
            display: none !important;
        }

        #results-container {
            margin-top: 40px;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }

        .chart-wrapper {
            max-width: 400px;
            margin: 20px auto;
        }

        #remedial-lesson h3 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .remedial-item {
            margin-bottom: 25px;
        }
        
        .remedial-item .question-text { font-weight: bold; }
        .remedial-item .user-answer { color: #e74c3c; }
        .remedial-item .correct-answer { color: #2ecc71; }
        
        .remedial-item .explanation {
            margin-top: 10px;
            font-size: 0.9em;
            background-color: #f4f7f9;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        .remedial-item .explanation .feedback-content p {
            font-size: 1em; /* Ajuste para melhor leitura */
        }


        /* --- Media Queries para Responsividade --- */
        @media (min-width: 768px) {
            .container {
                flex-direction: row; /* Layout lado a lado em telas maiores */
            }
            .sidebar {
                width: 280px;
                position: fixed;
                height: 100%;
            }
            .main-content {
                margin-left: 280px; /* Espaço para a sidebar fixa */
                padding: 40px;
            }
            .quiz-header h1 {
                font-size: 2.2em;
            }
        }
    </style>
</head>
<body>

    <!-- Container Principal que organiza o layout -->
    <div class="container">
        
        <!-- Barra Lateral para Navegação e Status -->
        <aside class="sidebar">
            <div class="logo">
                <h2>Mentor Constitucional</h2>
                <p>Aula 09: Liberdade de Expressão</p>
            </div>
            <nav class="navigation">
                <h3>Progresso</h3>
                <div id="progress-container">
                    <p>Questões Respondidas:</p>
                    <span id="progress-tracker">0 de 5</span>
                </div>
            </nav>
            <div class="footer">
                <p>&copy; 2024 - Preparação Elite</p>
            </div>
        </aside>

        <!-- Conteúdo Principal da Página -->
        <main class="main-content">
            <header class="quiz-header">
                <h1>Direitos Fundamentais: Direito à Liberdade de Expressão</h1>
                <p>Teste seus conhecimentos com base na Aula 09. Elimine as alternativas que julgar incorretas com o ícone (✂️) e selecione a correta.</p>
            </header>

            <!-- Onde as questões do quiz serão inseridas pelo JavaScript -->
            <div id="quiz-container"></div>

            <!-- Botão para finalizar e gerar o relatório -->
            <button id="submit-btn" class="hidden">Gerar Relatório de Desempenho</button>

            <!-- Seção de Resultados (inicialmente oculta) -->
            <section id="results-container" class="hidden">
                <h2>Relatório de Desempenho</h2>
                <div class="chart-wrapper">
                    <canvas id="results-chart"></canvas>
                </div>
                <div id="remedial-lesson">
                    <h3>Plano de Reforço Personalizado</h3>
                    <p>Abaixo estão os pontos que exigem sua atenção. Revise as mini-aulas para solidificar o conhecimento e não errar mais.</p>
                    <!-- A aula de reforço será inserida aqui -->
                </div>
            </section>
        </main>
    </div>

    <!-- 
        DOCUMENTAÇÃO: JAVASCRIPT INCORPORADO
        ------------------------------------
        A lógica do quiz está aqui. A propriedade `explanation` de cada questão
        foi elaborada como uma "mini-aula" detalhada, seguindo as diretrizes de
        excelência para garantir o aprendizado profundo.
    -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {

        const questions = [
            {
                question: "Qual dos seguintes incisos do Art. 5º da Constituição NÃO trata diretamente da Liberdade de Expressão, conforme listado na Aula 09?",
                options: [
                    "Inciso IV: 'é livre a manifestação do pensamento, sendo vedado o anonimato'",
                    "Inciso V: 'é assegurado o direito de resposta, proporcional ao agravo...'",
                    "Inciso IX: 'é livre a expressão da atividade intelectual, artística, científica e de comunicação...'",
                    "Inciso X: 'são invioláveis a intimidade, a vida privada, a honra e a imagem das pessoas...'",
                    "Todos os incisos mencionados tratam da Liberdade de Expressão."
                ],
                answer: 3,
                explanation: `
                    <div class="feedback-title correct-title">Análise da Resposta Correta</div>
                    <div class="feedback-content">
                        <p><strong>Distinguindo Direitos Correlatos:</strong> Exato! Esta questão testa sua atenção aos detalhes. Embora o inciso X (intimidade, vida privada, honra) esteja frequentemente em <strong>conflito</strong> com a liberdade de expressão, ele não a define. Pelo contrário, ele estabelece os <strong>limites</strong> da liberdade de expressão.</p>
                        <p>A Aula 09 aponta os seguintes como o núcleo duro da Liberdade de Expressão:</p>
                        <ul>
                            <li><strong>✅ Inciso IV:</strong> A base de tudo, a liberdade de pensar e manifestar o que pensa (com a contrapartida da responsabilidade, vedando o anonimato).</li>
                            <li><strong>✅ Inciso V:</strong> O remédio para o abuso da liberdade. Se alguém se excede, a vítima tem direito de resposta e indenização.</li>
                            <li><strong>✅ Inciso IX:</strong> A proteção específica para atividades intelectuais, artísticas e de comunicação, proibindo a censura prévia.</li>
                        </ul>
                        <p class="example"><strong>Analogia:</strong> Pense na liberdade de expressão como um carro (Incisos IV e IX). O direito à honra e à imagem (Inciso X) é o limite de velocidade e as leis de trânsito. O direito de resposta e indenização (Inciso V) é o seguro e a multa que você paga se causar um acidente. O Inciso X não é o carro, mas a regra que o limita.</p>
                        <p><strong>(Fonte: Aula09, p. 2)</strong></p>
                    </div>
                `
            },
            {
                question: "De acordo com a decisão do STF na ADI 4815, sobre biografias, qual princípio fundamental foi preponderante para a decisão de não exigir autorização prévia?",
                options: [
                    "O princípio da dignidade da pessoa humana do biografado.",
                    "O princípio da proteção à honra e à imagem.",
                    "A proibição da censura prévia, como um pilar da liberdade de expressão.",
                    "O direito econômico do autor e da editora.",
                    "O princípio do esquecimento."
                ],
                answer: 2,
                explanation: `
                    <div class="feedback-title correct-title">Análise da Resposta Correta</div>
                    <div class="feedback-content">
                        <p><strong>O Pilar da Decisão:</strong> Perfeito. O cerne da decisão do STF foi que exigir autorização do biografado (ou de sua família) para publicar uma biografia equivaleria a uma forma de <strong>censura prévia</strong>, o que é expressamente vedado pela Constituição (Art. 5º, IX e Art. 220).</p>
                        <p>A Corte entendeu que a liberdade de expressão não pode ser condicionada a um consentimento prévio, pois isso anularia o próprio direito. O controle sobre o conteúdo de uma obra deve ser feito <strong>a posteriori</strong> (depois da publicação), por meio de ações de reparação de danos, e não <strong>a priori</strong> (antes de publicar), através do bloqueio.</p>
                        <div class="visual-aid">🚫 Bloquear antes de publicar = Censura Prévia = Inconstitucional<br>⚖️ Processar depois de publicar por danos = Controle Posterior = Constitucional</div>
                        <p class="example"><strong>Exemplo Prático:</strong> Imagine que um jornalista queira publicar uma reportagem investigativa sobre um político. Se ele precisasse da autorização do político para publicar, a reportagem jamais sairia. O mesmo raciocínio se aplica às biografias. A liberdade de contar histórias e informar o público não pode depender da vontade de quem é retratado.</p>
                        <p><strong>(Fonte: Aula09, p. 2)</strong></p>
                    </div>
                `
            },
            {
                question: "Caso uma biografia publicada cause danos à honra de uma pessoa retratada, quais são os mecanismos de reparação previstos pelo STF e pela legislação?",
                options: [
                    "Apenas a retirada de todos os exemplares de circulação.",
                    "A prisão imediata do autor da biografia.",
                    "Apenas uma indenização em dinheiro.",
                    "Não há reparação possível, pois a liberdade de expressão é absoluta nesse caso.",
                    "Indenização pecuniária e outras formas de reparação, como publicação de ressalva ou direito de resposta."
                ],
                answer: 4,
                explanation: `
                    <div class="feedback-title correct-title">Análise da Resposta Correta</div>
                    <div class="feedback-content">
                        <p><strong>Reparação Integral e Proporcional:</strong> Resposta precisa! A decisão do STF, ao proibir a censura prévia, não deixou o biografado desprotegido. Pelo contrário, reforçou que o controle posterior deve ser efetivo. A reparação pelo abuso da liberdade de expressão não se limita ao dinheiro.</p>
                        <p>A Aula 09 destaca que a vítima do abuso pode buscar:</p>
                        <ul>
                            <li><strong>💰 Indenização Pecuniária:</strong> Para compensar os danos materiais (perdas financeiras) e morais (sofrimento, abalo à honra).</li>
                            <li><strong>🗣️ Medidas 'in natura':</strong> Outras formas que buscam restabelecer a verdade e a reputação, como:
                                <ul>
                                    <li><strong>Direito de Resposta:</strong> Publicar a sua versão dos fatos no mesmo veículo.</li>
                                    <li><strong>Publicação de Ressalva:</strong> Incluir uma nota de correção ou esclarecimento em futuras edições da obra.</li>
                                    <li><strong>Correção da Informação:</strong> Em casos de erros factuais claros.</li>
                                </ul>
                            </li>
                        </ul>
                        <p class="example"><strong>Cenário do Dia a Dia:</strong> Um livro biográfico afirma falsamente que uma empresária faliu uma de suas antigas empresas. Ela pode processar e pedir ao juiz, por exemplo, R$ 50.000,00 por danos à sua imagem de boa gestora e, cumulativamente, que a editora seja obrigada a inserir uma errata (uma nota de correção) em todos os novos exemplares do livro.</p>
                        <p><strong>(Fonte: Aula09, p. 2)</strong></p>
                    </div>
                `
            },
            {
                question: "A jurisprudência do STF sobre a liberdade de expressão, incluindo os casos de sátiras a candidatos e conteúdos polêmicos em plataformas de streaming, reforça qual entendimento?",
                options: [
                    "A necessidade de um controle prévio mais rígido sobre conteúdos humorísticos.",
                    "Que a liberdade de expressão só protege discursos que agradam a maioria da população.",
                    "A forte repressão à censura prévia, optando-se por mecanismos de responsabilização posterior.",
                    "Que a liberdade de expressão é ilimitada durante o período eleitoral.",
                    "A proibição de qualquer tipo de sátira ou crítica a figuras públicas."
                ],
                answer: 2,
                explanation: `
                    <div class="feedback-title correct-title">Análise da Resposta Correta</div>
                    <div class="feedback-content">
                        <p><strong>A Regra de Ouro: Proibição da Censura Prévia:</strong> Perfeito! A sua resposta sintetiza a linha de pensamento consistente do STF. Seja no caso das biografias, das sátiras políticas (ADI 4451) ou da retirada de conteúdo de streaming (Rcl 38782), a mensagem da Corte é a mesma: a regra geral é a liberdade, e o controle de eventuais abusos deve ser feito <strong>depois</strong>, nunca <strong>antes</strong>.</p>
                        <p>A democracia pressupõe a circulação de ideias, mesmo as mais polêmicas, chocantes ou satíricas. O papel do Estado não é filtrar o que a população pode ou não ver/ler, mas sim garantir que, se houver um abuso que cause dano, a vítima tenha mecanismos eficazes para ser reparada.</p>
                        <div class="visual-aid">🤔 Alguém se sentiu ofendido? ➡️ ⚖️ Procure a Justiça!<br>🤔 Alguém pode se sentir ofendido? ➡️ 🚫 Proibido proibir antes!</div>
                        <p class="example"><strong>Exemplo Prático:</strong> Um programa de comédia faz uma charge que um determinado grupo religioso considera ofensiva. Esse grupo não pode obter uma liminar para impedir que o programa vá ao ar (censura prévia). No entanto, depois da exibição, se eles conseguirem provar que o programa incitou o ódio ou a violência contra eles (ultrapassando os limites da sátira), podem processar a emissora por danos morais coletivos.</p>
                        <p><strong>(Fonte: Aula09, p. 3)</strong></p>
                    </div>
                `
            },
             {
                question: "O direito à liberdade de expressão da atividade intelectual, artística, científica e de comunicação, conforme o Art. 5º, IX, da CF, independe de:",
                options: [
                    "Responsabilização por danos.",
                    "Respeito aos direitos autorais.",
                    "Censura ou licença.",
                    "Pagamento de impostos sobre a atividade.",
                    "Veracidade das informações."
                ],
                answer: 2,
                explanation: `
                    <div class="feedback-title correct-title">Análise da Resposta Correta</div>
                    <div class="feedback-content">
                        <p><strong>Liberdade na Fonte:</strong> Exato! Este inciso é o coração da proteção contra a censura estatal. Ele garante que a criação e a circulação de obras intelectuais e artísticas não dependam de uma autorização prévia do Estado.</p>
                        <ul>
                            <li><strong>Censura:</strong> É a análise prévia do conteúdo de uma obra por um agente estatal para decidir se ela pode ou não ser publicada/exibida. <strong>É VEDADA.</strong></li>
                            <li><strong>Licença:</strong> É uma autorização formal que o Estado concede para que alguém possa exercer uma atividade. Para a expressão intelectual e artística, essa licença prévia <strong>NÃO É EXIGIDA</strong>.</li>
                        </ul>
                        <p>Isso significa que um artista não precisa submeter o roteiro de seu filme a uma comissão do governo para poder filmá-lo, nem um cientista precisa de permissão para publicar os resultados de sua pesquisa.</p>
                        <p class="example"><strong>Cenário do Dia a Dia:</strong> Você quer criar um canal no YouTube para fazer críticas de cinema. Você não precisa de nenhuma 'licença de youtuber' ou 'autorização de crítico' do governo para começar. Você simplesmente cria e publica. A sua liberdade de expressão dessa atividade é garantida sem a necessidade de uma permissão estatal prévia. A responsabilidade pelo que você disser, contudo, é outra história e será analisada posteriormente, se alguém se sentir lesado.</p>
                        <p><strong>(Fonte: Aula09, p. 2)</strong></p>
                    </div>
                `
            }
        ];
        
        const quizContainer = document.getElementById('quiz-container');
        const submitBtn = document.getElementById('submit-btn');
        const resultsContainer = document.getElementById('results-container');
        const progressTracker = document.getElementById('progress-tracker');
        
        let userAnswers = {}; 
        let answeredQuestionsCount = 0;

        function renderQuiz() {
            let quizHTML = '';
            questions.forEach((q, index) => {
                quizHTML += `
                    <div class="question-card" id="q-${index}">
                        <h3>${index + 1}. ${q.question}</h3>
                        <ul class="options" data-question-index="${index}">
                            ${q.options.map((option, i) => `
                                <li>
                                    <input type="radio" name="q${index}" id="q${index}o${i}" value="${i}">
                                    <label for="q${index}o${i}">${String.fromCharCode(65 + i)}) ${option}</label>
                                    <button class="eliminate-btn" title="Eliminar esta alternativa">✂️</button>
                                </li>
                            `).join('')}
                        </ul>
                        <div class="feedback"></div>
                    </div>
                `;
            });
            quizContainer.innerHTML = quizHTML;
        }

        function handleOptionSelect(questionIndex, selectedIndex) {
            if (userAnswers.hasOwnProperty(questionIndex)) return;

            userAnswers[questionIndex] = parseInt(selectedIndex);
            answeredQuestionsCount++;
            updateProgress();

            const questionCard = document.getElementById(`q-${questionIndex}`);
            const feedbackEl = questionCard.querySelector('.feedback');
            const optionsList = questionCard.querySelector('.options');
            const correctIndex = questions[questionIndex].answer;

            const isCorrect = userAnswers[questionIndex] === correctIndex;

            if (isCorrect) {
                feedbackEl.classList.add('correct');
                feedbackEl.innerHTML = questions[questionIndex].explanation;
            } else {
                feedbackEl.classList.add('incorrect');
                const incorrectExplanation = questions[questionIndex].explanation.replace('feedback-title correct-title', 'feedback-title incorrect-title').replace('Análise da Resposta Correta', 'Análise da Resposta Incorreta');
                feedbackEl.innerHTML = incorrectExplanation;
                optionsList.children[selectedIndex].classList.add('incorrect-selection');
            }
            
            optionsList.children[correctIndex].classList.add('correct-answer');

            Array.from(optionsList.children).forEach(li => {
                li.style.pointerEvents = 'none';
                li.querySelector('.eliminate-btn').style.display = 'none';
            });
        }

        function handleEliminate(target) {
            const listItem = target.closest('li');
            if (listItem) {
                listItem.classList.add('eliminated');
                listItem.querySelector('input').disabled = true;
            }
        }

        function updateProgress() {
            progressTracker.textContent = `${answeredQuestionsCount} de ${questions.length}`;
            if (answeredQuestionsCount === questions.length) {
                submitBtn.classList.remove('hidden');
            }
        }

        function showResults() {
            quizContainer.classList.add('hidden');
            submitBtn.classList.add('hidden');
            resultsContainer.classList.remove('hidden');

            let score = 0;
            questions.forEach((q, i) => {
                if (userAnswers[i] === q.answer) {
                    score++;
                }
            });
            const incorrect = questions.length - score;

            renderChart(score, incorrect);
            generateRemedialLesson();
        }
        
        function renderChart(correct, incorrect) {
            const ctx = document.getElementById('results-chart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Acertos', 'Erros'],
                    datasets: [{
                        data: [correct, incorrect],
                        backgroundColor: ['#2ecc71', '#e74c3c'],
                        borderColor: ['#ffffff', '#ffffff'],
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' },
                        title: { display: true, text: 'Seu Desempenho Geral' }
                    }
                }
            });
        }

        function generateRemedialLesson() {
            const lessonContainer = document.getElementById('remedial-lesson');
            let lessonHTML = `<h3>Plano de Reforço Personalizado</h3>`; 
            
            let hasErrors = false;
            questions.forEach((question, i) => {
                if (userAnswers[i] !== question.answer) {
                    hasErrors = true;
                    const userAnswerText = question.options[userAnswers[i]];
                    
                    lessonHTML += `
                        <div class="remedial-item">
                            <p class="question-text">${i + 1}. ${question.question}</p>
                            <p><strong>Sua resposta (incorreta):</strong> <span class="user-answer">${String.fromCharCode(65 + userAnswers[i])}) ${userAnswerText}</span></p>
                            <div class="explanation">
                                ${questions[i].explanation.replace('feedback-title correct-title', 'feedback-title incorrect-title').replace('Análise da Resposta Correta', 'Análise Detalhada da Questão')}
                            </div>
                        </div>
                    `;
                }
            });
            
            if (!hasErrors) {
                lessonHTML += "<p><strong>Excelente performance!</strong> Gabaritar este tema demonstra que você compreendeu a fundo a posição do STF sobre a liberdade de expressão e a vedação à censura. Continue com essa dedicação!</p>";
            } else {
                 lessonHTML = `<h3>Plano de Reforço Personalizado</h3><p>Abaixo estão os pontos que exigem sua atenção. Revise as mini-aulas para solidificar o conhecimento e não errar mais.</p>` + lessonHTML.replace('<h3>Plano de Reforço Personalizado</h3>', '');
            }

            lessonContainer.innerHTML = lessonHTML;
        }

        renderQuiz();

        quizContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('eliminate-btn')) {
                handleEliminate(e.target);
                return;
            }

            const label = e.target.closest('label');
            if (label) {
                const radio = document.getElementById(label.htmlFor);
                if (radio && !radio.disabled) {
                    const questionIndex = radio.name.replace('q', '');
                    handleOptionSelect(questionIndex, radio.value);
                }
            }
        });

        submitBtn.addEventListener('click', showResults);
    });
    </script>
</body>
</html>
