<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questões de Fixação - Fato Típico: Nexo Causal (Parte I)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        /* Estilos Globais e Paleta de Cores */
        :root {
            --primary-blue: #0A3D62;
            --secondary-blue: #1E639B;
            --light-gray: #F0F2F5;
            --medium-gray: #D1D5DB;
            --dark-gray: #4B5563;
            --text-color: #1F2937;
            --success-green: #10B981;
            --error-red: #EF4444;
            --white: #FFFFFF;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--light-gray);
            color: var(--text-color);
            display: flex;
        }

        /* Estilo da Sidebar */
        #sidebar {
            width: 250px;
            background-color: var(--primary-blue);
            color: var(--white);
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            padding: 2rem 1rem;
            transition: width 0.3s;
            overflow-y: auto;
            z-index: 1000;
        }

        #sidebar h2 {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--secondary-blue);
            padding-bottom: 1rem;
        }

        #sidebar ul {
            list-style: none;
            padding: 0;
        }

        #sidebar ul li a {
            display: block;
            padding: 0.8rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            text-decoration: none;
            color: var(--white);
            transition: background-color 0.3s, color 0.3s;
            font-weight: 500;
        }

        #sidebar ul li a:hover, #sidebar ul li a.active {
            background-color: var(--white);
            color: var(--primary-blue);
        }

        /* Conteúdo Principal */
        #main-content {
            margin-left: 250px;
            padding: 2rem 3rem;
            width: calc(100% - 250px);
            transition: margin-left 0.3s, width 0.3s;
        }

        /* Estilo dos Cards de Questão */
        .question-card {
            background-color: var(--white);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 5px solid var(--primary-blue);
        }

        .question-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }

        /* Estilo das Alternativas */
        .option {
            display: flex;
            align-items: center;
            padding: 1rem;
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
            position: relative;
        }

        .option:hover {
            background-color: #EBF5FF;
            border-color: var(--secondary-blue);
        }
        
        .option.correct {
            background-color: var(--success-green);
            color: var(--white);
            border-color: #059669;
        }

        .option.incorrect {
            background-color: var(--error-red);
            color: var(--white);
            border-color: #DC2626;
        }
        
        .option.eliminated {
            text-decoration: line-through;
            background-color: var(--medium-gray);
            opacity: 0.6;
            cursor: not-allowed;
        }

        .option-letter {
            font-weight: bold;
            margin-right: 1rem;
            min-width: 20px;
        }
        
        .scissor-icon {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: var(--dark-gray);
            transition: color 0.2s;
        }
        
        .scissor-icon:hover {
            color: var(--error-red);
        }
        .option.eliminated .scissor-icon, .option.correct .scissor-icon, .option.incorrect .scissor-icon {
            display: none;
        }

        /* Estilo do Feedback */
        .feedback {
            margin-top: 1.5rem;
            padding: 1.5rem;
            border-radius: 8px;
            display: none;
        }

        .feedback.correct {
            background-color: #D1FAE5;
            border-left: 5px solid var(--success-green);
            display: block;
        }

        .feedback.incorrect {
            background-color: #FEE2E2;
            border-left: 5px solid var(--error-red);
            display: block;
        }
        
        .feedback-title {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        
        .feedback-explanation {
            line-height: 1.6;
        }
        
        .feedback-example {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f3f4f6;
            border-radius: 6px;
            border-left: 3px solid var(--secondary-blue);
        }

        /* Seção de Relatório */
        #report-section {
            background-color: var(--white);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        #review-section {
            margin-top: 2rem;
        }

        .review-card {
            background-color: #FFFBEB;
            border: 1px solid #FBBF24;
            border-left: 5px solid #F59E0B;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body>

    <div id="sidebar">
        <h2>Direito Penal</h2>
        <ul>
            <li><a href="#quiz-section" onclick="scrollToSection('quiz-section')" class="active">Questões</a></li>
            <li><a href="#report-section" onclick="scrollToSection('report-section')">Relatório</a></li>
        </ul>
    </div>

    <div id="main-content">
        <h1 class="text-3xl font-bold mb-2 text-[var(--primary-blue)]">Questões de Fixação: Fato Típico - Nexo Causal (Parte I)</h1>
        <p class="mb-8 text-[var(--dark-gray)]">Aula 22 - Analise cada questão e selecione a alternativa correta. Use o ícone de tesoura <i class="fas fa-cut"></i> para eliminar as alternativas que julgar incorretas.</p>

        <div id="quiz-section">
            <!-- As questões serão inseridas aqui via JavaScript -->
        </div>

        <div id="report-section" class="hidden">
            <h2 class="text-2xl font-bold mb-6 text-[var(--primary-blue)]">Relatório de Desempenho</h2>
            <div class="w-full md:w-1/2 mx-auto mb-8">
                <canvas id="performance-chart"></canvas>
            </div>
            <div id="review-section">
                <!-- A revisão dos erros será inserida aqui -->
            </div>
        </div>
    </div>

    <script>
    // DOCUMENTAÇÃO GERAL DO SCRIPT (JavaScript)
    // Módulo da Aula 22: Nexo Causal (Parte I).
    // O script foi populado com questões sobre as teorias do nexo causal, com ênfase na teoria da equivalência dos antecedentes
    // e no método da eliminação hipotética, mantendo o padrão de "mini-aulas" interativas.

    const questions = [
        {
            question: "O Art. 13, caput, do Código Penal estabelece que 'Considera-se causa a ação ou omissão sem a qual o resultado não teria ocorrido'. Qual teoria sobre o nexo causal foi adotada como regra pelo ordenamento jurídico brasileiro?",
            options: [
                "Teoria da Causalidade Adequada.",
                "Teoria da Relevância Jurídica.",
                "Teoria da Imputação Objetiva.",
                "Teoria da Equivalência dos Antecedentes ou 'conditio sine qua non'.",
                "Teoria da Causalidade Hipotética."
            ],
            answer: 3,
            explanation:
                '<div class="feedback-explanation">' +
                    '<p><strong>Mini-Aula sobre a Alternativa Correta (D):</strong></p>' +
                    '<p>A redação do Art. 13, caput, é a materialização exata da <strong>Teoria da Equivalência dos Antecedentes</strong>, também conhecida por sua expressão em latim, <i>conditio sine qua non</i> (condição sem a qual não).</p>' +
                    '<p>Para essa teoria, <strong>toda e qualquer condição</strong> que tenha contribuído para o resultado é considerada sua causa, possuindo o mesmo valor (são equivalentes). Não se faz uma distinção entre causas mais ou menos importantes. Se uma ação ou omissão foi necessária para a ocorrência do resultado, ela é sua causa.</p>' +
                    '<ul>' +
                        '<li class="mt-2"><strong>- Causalidade Adequada (Alternativa A):</strong> É a teoria adotada como exceção, não como regra. Ela seleciona como causa apenas a condição mais "apta" ou "adequada" a produzir o resultado.</li>' +
                        '<li class="mt-1"><strong>- Imputação Objetiva (Alternativa C):</strong> É uma teoria mais moderna que funciona como um filtro para a teoria da equivalência, analisando se o agente criou um risco proibido e se esse risco se realizou no resultado. Não é a teoria primária adotada no texto da lei.</li>' +
                    '</ul>' +
                '</div>' +
                '<div class="feedback-example">' +
                    '<p><strong>Exemplo Prático:</strong> "A" vende uma arma para "B", que a utiliza para matar "C". Pela teoria da equivalência, a venda da arma por "A" é uma condição sem a qual o resultado (morte por aquela arma) não teria ocorrido. Portanto, a venda é uma das causas. A responsabilização penal de "A", contudo, dependerá de outro fator: se ele agiu com dolo ou culpa (se sabia ou devia saber da intenção de "B").</p>' +
                '</div>' +
                '<p class="mt-3 text-sm text-gray-600"><em>Referência: Aula 22, p. 2</em></p>',
            topic: "Teoria da Equivalência dos Antecedentes (Regra Geral)"
        },
        {
            question: "Para aplicar a teoria da 'conditio sine qua non', a doutrina utiliza um procedimento mental conhecido como método da eliminação hipotética de Thyrén. Como funciona esse método?",
            options: [
                "Inclui-se mentalmente uma nova causa para verificar se o resultado se altera.",
                "Elimina-se mentalmente a conduta do agente e, se o resultado ainda assim ocorrer, a conduta não é considerada causa.",
                "Elimina-se mentalmente o resultado para verificar se a conduta do agente era dolosa ou culposa.",
                "Compara-se a conduta do agente com a de um homem médio para aferir a previsibilidade.",
                "Analisa-se qual das causas foi a mais adequada e eficiente para produzir o resultado."
            ],
            answer: 1,
            explanation:
                '<div class="feedback-explanation">' +
                    '<p><strong>Mini-Aula sobre a Alternativa Correta (B):</strong></p>' +
                    '<p>O <strong>método da eliminação hipotética</strong> é a ferramenta prática para se descobrir se uma conduta é ou não causa do resultado. O processo é um exercício de abstração:</p>' +
                    '<ul>' +
                        '<li class="mt-2"><strong>1. Identifique a conduta</strong> que você quer analisar.</li>' +
                        '<li class="mt-1"><strong>2. Suprima (elimine) mentalmente</strong> essa conduta da cadeia de acontecimentos.</li>' +
                        '<li class="mt-1"><strong>3. Pergunte-se:</strong> "Sem essa conduta, o resultado, tal como ocorreu, ainda teria acontecido?".</li>' +
                        '<li class="mt-1"><strong>- Se a resposta for NÃO</strong> (o resultado desaparece), então a conduta eliminada <strong>é causa</strong>.</li>' +
                        '<li class="mt-1"><strong>- Se a resposta for SIM</strong> (o resultado permanece), então a conduta eliminada <strong>não é causa</strong>.</li>' +
                    '</ul>' +
                '</div>' +
                '<div class="feedback-example">' +
                    '<p><strong>Exemplo Prático:</strong> "A", querendo matar "B", se hospeda em um hotel (conduta 1) e depois atira em "B" (conduta 2), matando-o. Vamos analisar a conduta 1 (hospedar-se). Se eliminarmos mentalmente a hospedagem, "A" ainda poderia ter matado "B"? Sim. Portanto, a hospedagem não é causa da morte. Agora, vamos analisar a conduta 2 (atirar). Se eliminarmos o disparo, "B" teria morrido (daquela forma)? Não. Portanto, o disparo <strong>é causa</strong> da morte.</p>' +
                '</div>' +
                '<p class="mt-3 text-sm text-gray-600"><em>Referência: Aula 22, p. 3</em></p>',
            topic: "Método da Eliminação Hipotética"
        },
        {
            question: "Uma das críticas feitas à Teoria da Equivalência dos Antecedentes é a chamada 'regressão ao infinito', que, em tese, poderia levar à responsabilização penal de causas muito remotas. Como a doutrina majoritária refuta essa crítica?",
            options: [
                "Limitando a análise causal apenas à última conduta antes do resultado.",
                "Afirmando que a crítica é válida e que a teoria é inaplicável.",
                "Adotando a teoria da causalidade adequada em todos os casos.",
                "Explicando que o nexo causal é apenas o primeiro filtro, e que a responsabilidade penal exige também a análise do elemento subjetivo (dolo ou culpa), que limita o regresso.",
                "Criando a teoria da imputação objetiva para substituir a teoria da equivalência."
            ],
            answer: 3,
            explanation:
                '<div class="feedback-explanation">' +
                    '<p><strong>Mini-Aula sobre a Alternativa Correta (D):</strong></p>' +
                    '<p>A crítica da "regressão ao infinito" é a de que, se toda condição é causa, poderíamos responsabilizar o fabricante da arma, os pais que geraram o criminoso, e assim por diante, infinitamente. A doutrina considera essa crítica despropositada por uma razão simples: o <strong>nexo de causalidade é um elo físico, objetivo</strong>, mas a <strong>responsabilidade penal é subjetiva</strong>.</p>' +
                    '<p>Para que alguém seja punido, não basta que sua conduta seja causa do resultado. É preciso um segundo passo: verificar se essa pessoa agiu com <strong>dolo ou culpa</strong> em relação à sua conduta e ao resultado. Esse elemento subjetivo funciona como uma barreira, um filtro que impede a regressão infinita.</p>' +
                '</div>' +
                '<div class="feedback-example">' +
                    '<p><strong>Exemplo Prático:</strong> O marceneiro que fabricou a cama onde os pais do criminoso o conceberam é, numa análise puramente física e hipotética, uma causa remota do crime. No entanto, ele jamais será responsabilizado, pois não agiu com dolo ou culpa em relação ao homicídio que seria praticado décadas depois. Sua conduta não teve o fim de gerar um criminoso, nem foi negligente nesse sentido. A ausência do elemento subjetivo quebra a responsabilidade.</p>' +
                '</div>' +
                '<p class="mt-3 text-sm text-gray-600"><em>Referência: Aula 22, p. 4</em></p>',
            topic: "Crítica da Regressão ao Infinito e o Filtro do Dolo/Culpa"
        },
        {
            question: "Embora a regra seja a Teoria da Equivalência dos Antecedentes, o Código Penal adota excepcionalmente a Teoria da Causalidade Adequada. Em qual situação essa teoria é aplicada?",
            options: [
                "Em todos os crimes culposos.",
                "Nos crimes omissivos impróprios.",
                "Na hipótese de superveniência de causa relativamente independente que, por si só, produziu o resultado (art. 13, § 1º, CP).",
                "Em todos os crimes formais e de mera conduta.",
                "Quando há participação de menor importância."
            ],
            answer: 2,
            explanation:
                '<div class="feedback-explanation">' +
                    '<p><strong>Mini-Aula sobre a Alternativa Correta (C):</strong></p>' +
                    '<p>O Código Penal abre uma exceção à regra da <i>conditio sine qua non</i> para resolver problemas com as concausas (assunto da próxima aula). A <strong>Teoria da Causalidade Adequada</strong>, que considera causa apenas a conduta mais "adequada" ou "idônea" a produzir o resultado, é usada como um corretivo em uma situação específica: a do <strong>art. 13, § 1º</strong>.</p>' +
                    '<p>Este artigo trata da <strong>causa superveniente (posterior à conduta) que é relativamente independente</strong> (tem alguma relação com a conduta inicial), mas que tem força para, <strong>por si só</strong>, causar o resultado. Nesses casos, a lei rompe o nexo causal em relação ao resultado mais grave, e o agente inicial responde apenas pelos atos que já praticou. A lei, aqui, seleciona a causa mais "adequada" (a superveniente) como a verdadeira produtora do resultado final.</p>' +
                '</div>' +
                '<div class="feedback-example">' +
                    '<p><strong>Exemplo Prático:</strong> "A" fere "B" com uma faca (lesão leve). A caminho do hospital, a ambulância que transporta "B" é atingida por um raio e explode, matando "B". A ida ao hospital tem relação com a facada (causa relativamente independente e superveniente). Contudo, a explosão da ambulância por um raio é um evento tão extraordinário que produziu o resultado morte "por si só". Pela teoria da causalidade adequada (exceção), "A" não responde pela morte, mas apenas pelo que ele efetivamente fez: tentativa de homicídio ou lesão corporal.</p>' +
                '</div>' +
                '<p class="mt-3 text-sm text-gray-600"><em>Referência: Aula 22, p. 4</em></p>',
            topic: "Teoria da Causalidade Adequada (Exceção)"
        }
    ];

    const userAnswers = new Array(questions.length).fill(null);
    const quizContainer = document.getElementById('quiz-section');
    const reportSection = document.getElementById('report-section');
    let performanceChart = null;

    function renderQuestions() {
        let quizHTML = '';
        questions.forEach((q, index) => {
            quizHTML +=
                '<div class="question-card" id="question-' + index + '">' +
                    '<p class="question-title">' + (index + 1) + '. ' + q.question + '</p>' +
                    '<div class="options-container">';
            q.options.forEach((option, optionIndex) => {
                quizHTML +=
                    '<div class="option" data-question="' + index + '" data-option="' + optionIndex + '">' +
                        '<span class="option-letter">' + String.fromCharCode(65 + optionIndex) + '</span>' +
                        '<span class="option-text">' + option + '</span>' +
                        '<i class="fas fa-cut scissor-icon" title="Eliminar alternativa"></i>' +
                    '</div>';
            });
            quizHTML +=
                    '</div>' +
                    '<div class="feedback" id="feedback-' + index + '"></div>' +
                '</div>';
        });
        quizContainer.innerHTML = quizHTML;
        addEventListeners();
    }

    function addEventListeners() {
        document.querySelectorAll('.option').forEach(option => {
            option.addEventListener('click', handleOptionSelect);
        });
        document.querySelectorAll('.scissor-icon').forEach(icon => {
            icon.addEventListener('click', handleEliminateOption);
        });
    }

    function handleEliminateOption(e) {
        e.stopPropagation();
        const optionDiv = e.target.parentElement;
        if (!optionDiv.classList.contains('eliminated') && userAnswers[optionDiv.dataset.question] === null) {
            optionDiv.classList.add('eliminated');
        }
    }

    function handleOptionSelect(e) {
        const selectedOption = e.currentTarget;
        const questionIndex = parseInt(selectedOption.dataset.question);
        const optionIndex = parseInt(selectedOption.dataset.option);

        if (userAnswers[questionIndex] !== null || selectedOption.classList.contains('eliminated')) {
            return;
        }

        const isCorrect = optionIndex === questions[questionIndex].answer;
        userAnswers[questionIndex] = { answered: optionIndex, correct: isCorrect };

        const optionsContainer = selectedOption.parentElement;
        optionsContainer.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));

        selectedOption.classList.add(isCorrect ? 'correct' : 'incorrect');
        
        optionsContainer.querySelectorAll('.scissor-icon').forEach(icon => icon.style.display = 'none');

        showFeedback(questionIndex, isCorrect);
        
        if (userAnswers.every(answer => answer !== null)) {
            reportSection.classList.remove('hidden');
            generateReport();
            scrollToSection('report-section');
        }
    }

    function showFeedback(questionIndex, isCorrect) {
        const feedbackDiv = document.getElementById('feedback-' + questionIndex);
        const questionData = questions[questionIndex];
        
        let feedbackHTML = 
            '<p class="feedback-title">' + (isCorrect ? 'Resposta Correta! Análise do Professor:' : 'Resposta Incorreta. Análise do Professor:') + '</p>' +
            '<div>' + questionData.explanation + '</div>';
        
        feedbackDiv.innerHTML = feedbackHTML;
        feedbackDiv.className = 'feedback ' + (isCorrect ? 'correct' : 'incorrect');
    }
    
    function generateReport() {
        const correctAnswers = userAnswers.filter(a => a.correct).length;
        const incorrectAnswers = questions.length - correctAnswers;

        const ctx = document.getElementById('performance-chart').getContext('2d');
        if (performanceChart) {
            performanceChart.destroy();
        }
        performanceChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Acertos', 'Erros'],
                datasets: [{
                    data: [correctAnswers, incorrectAnswers],
                    backgroundColor: ['var(--success-green)', 'var(--error-red)'],
                    borderColor: ['var(--white)'],
                    borderWidth: 4
                }]
            },
            options: {
                responsive: true,
                cutout: '70%',
                plugins: {
                    legend: { position: 'bottom', labels: { font: { size: 14 }, padding: 20 } },
                    title: { display: true, text: 'Seu Desempenho Geral', font: { size: 18, weight: 'bold' }, padding: { bottom: 20 } }
                }
            }
        });

        const reviewSection = document.getElementById('review-section');
        let reviewHTML = '<h3 class="text-xl font-bold mb-4 text-[var(--primary-blue)]">Pontos para Revisão</h3>';
        const incorrectQuestions = userAnswers
            .map((answer, index) => ({...answer, index}))
            .filter(answer => !answer.correct);

        if (incorrectQuestions.length === 0) {
            reviewHTML += '<p class="text-lg text-[var(--success-green)] font-semibold">Excelente! Você estabeleceu um sólido nexo causal com o conhecimento. Prossiga.</p>';
        } else {
            reviewHTML += '<p class="mb-4 text-[var(--dark-gray)]">Você errou ' + incorrectQuestions.length + ' questão(ões). A corrente da aprovação não pode ter elos fracos. Revise estes pontos:</p>';
            incorrectQuestions.forEach(q => {
                const originalQuestion = questions[q.index];
                reviewHTML +=
                    '<div class="review-card">' +
                        '<h4 class="font-bold text-lg mb-2 text-[#D97706]">' + originalQuestion.topic + '</h4>' +
                        '<p class="mb-3"><strong>Na questão:</strong> "' + originalQuestion.question + '"</p>' +
                        '<p class="font-semibold">Relembre o ponto-chave:</p>' +
                        originalQuestion.explanation +
                    '</div>';
            });
        }
        reviewSection.innerHTML = reviewHTML;
    }

    function scrollToSection(sectionId) {
        document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
    }

    window.addEventListener('scroll', () => {
        const sections = ['quiz-section', 'report-section'];
        let currentSection = '';

        sections.forEach(sectionId => {
            const section = document.getElementById(sectionId);
            if (section) {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 150 && rect.bottom >= 150) {
                    currentSection = sectionId;
                }
            }
        });
        
        const sidebarLinks = document.querySelectorAll('#sidebar ul li a');
        sidebarLinks.forEach(link => {
            link.classList.remove('active');
            if(link.getAttribute('href') === '#' + currentSection) {
                link.classList.add('active');
            }
        });
    });

    document.addEventListener('DOMContentLoaded', renderQuestions);
    </script>

</body>
</html>
