<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questões de Fixação - Infração Penal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        /* Estilos Globais e Paleta de Cores */
        :root {
            --primary-blue: #0A3D62;
            --secondary-blue: #1E639B;
            --light-gray: #F0F2F5;
            --medium-gray: #D1D5DB;
            --dark-gray: #4B5563;
            --text-color: #1F2937;
            --success-green: #10B981;
            --error-red: #EF4444;
            --white: #FFFFFF;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--light-gray);
            color: var(--text-color);
            display: flex;
        }

        /* Estilo da Sidebar */
        #sidebar {
            width: 250px;
            background-color: var(--primary-blue);
            color: var(--white);
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            padding: 2rem 1rem;
            transition: width 0.3s;
            overflow-y: auto;
            z-index: 1000;
        }

        #sidebar h2 {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--secondary-blue);
            padding-bottom: 1rem;
        }

        #sidebar ul {
            list-style: none;
            padding: 0;
        }

        #sidebar ul li a {
            display: block;
            padding: 0.8rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            text-decoration: none;
            color: var(--white);
            transition: background-color 0.3s, color 0.3s;
            font-weight: 500;
        }

        #sidebar ul li a:hover, #sidebar ul li a.active {
            background-color: var(--white);
            color: var(--primary-blue);
        }

        /* Conteúdo Principal */
        #main-content {
            margin-left: 250px;
            padding: 2rem 3rem;
            width: calc(100% - 250px);
            transition: margin-left 0.3s, width 0.3s;
        }

        /* Estilo dos Cards de Questão */
        .question-card {
            background-color: var(--white);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 5px solid var(--primary-blue);
        }

        .question-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }

        /* Estilo das Alternativas */
        .option {
            display: flex;
            align-items: center;
            padding: 1rem;
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
            position: relative;
        }

        .option:hover {
            background-color: #EBF5FF; /* Um azul bem claro */
            border-color: var(--secondary-blue);
        }

        .option.selected {
            background-color: var(--secondary-blue);
            color: var(--white);
            border-color: var(--primary-blue);
        }
        
        .option.correct {
            background-color: var(--success-green);
            color: var(--white);
            border-color: #059669;
        }

        .option.incorrect {
            background-color: var(--error-red);
            color: var(--white);
            border-color: #DC2626;
        }
        
        .option.eliminated {
            text-decoration: line-through;
            background-color: var(--medium-gray);
            opacity: 0.6;
            cursor: not-allowed;
        }

        .option-letter {
            font-weight: bold;
            margin-right: 1rem;
            min-width: 20px;
        }
        
        .scissor-icon {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: var(--dark-gray);
            transition: color 0.2s;
        }
        
        .scissor-icon:hover {
            color: var(--error-red);
        }
        .option.eliminated .scissor-icon, .option.correct .scissor-icon, .option.incorrect .scissor-icon {
            display: none;
        }

        /* Estilo do Feedback */
        .feedback {
            margin-top: 1.5rem;
            padding: 1.5rem;
            border-radius: 8px;
            display: none; /* Começa oculto */
        }

        .feedback.correct {
            background-color: #D1FAE5;
            border-left: 5px solid var(--success-green);
            display: block;
        }

        .feedback.incorrect {
            background-color: #FEE2E2;
            border-left: 5px solid var(--error-red);
            display: block;
        }
        
        .feedback-title {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        /* Seção de Relatório */
        #report-section {
            background-color: var(--white);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        #review-section {
            margin-top: 2rem;
        }

        .review-card {
            background-color: #FFFBEB;
            border: 1px solid #FBBF24;
            border-left: 5px solid #F59E0B;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body>

    <!-- 
      DOCUMENTAÇÃO DA SIDEBAR
      - ID: sidebar
      - Propósito: Navegação principal entre as seções do quiz (questões e relatório).
      - Estrutura: Contém um título (h2) e uma lista não ordenada (ul) de links.
      - Funcionalidade (JS): Os links na sidebar usam a função `scrollToSection` para rolar suavemente até a seção correspondente no conteúdo principal. A classe 'active' é dinamicamente adicionada ao link da seção visível na tela.
    -->
    <div id="sidebar">
        <h2>Direito Penal</h2>
        <ul>
            <li><a href="#quiz-section" onclick="scrollToSection('quiz-section')" class="active">Questões</a></li>
            <li><a href="#report-section" onclick="scrollToSection('report-section')">Relatório</a></li>
        </ul>
    </div>

    <!-- 
      DOCUMENTAÇÃO DO CONTEÚDO PRINCIPAL
      - ID: main-content
      - Propósito: Container para todas as seções interativas, incluindo as questões, o relatório e a revisão.
    -->
    <div id="main-content">
        <h1 class="text-3xl font-bold mb-2 text-[var(--primary-blue)]">Questões de Fixação: Infração Penal</h1>
        <p class="mb-8 text-[var(--dark-gray)]">Aula 15 - Analise cada questão e selecione a alternativa correta. Use o ícone de tesoura <i class="fas fa-cut"></i> para eliminar as alternativas que julgar incorretas.</p>

        <!-- 
          DOCUMENTAÇÃO DA SEÇÃO DO QUIZ
          - ID: quiz-section
          - Propósito: Agrupa todos os cards de questões.
          - Estrutura: Cada questão é um 'div.question-card'.
        -->
        <div id="quiz-section">
            <!-- As questões serão inseridas aqui via JavaScript -->
        </div>

        <!-- 
          DOCUMENTAÇÃO DA SEÇÃO DE RELATÓRIO
          - ID: report-section
          - Propósito: Exibir o desempenho do aluno após a conclusão do quiz.
          - Estrutura: 
            - Título (h2).
            - Container para o gráfico de pizza (div > canvas#performance-chart).
            - Container para a revisão dos erros (div#review-section).
          - Funcionalidade (JS): Esta seção é preenchida pela função `generateReport` quando todas as questões são respondidas. O gráfico é renderizado usando Chart.js e a seção de revisão é populada com os tópicos das questões erradas.
        -->
        <div id="report-section" class="hidden">
            <h2 class="text-2xl font-bold mb-6 text-[var(--primary-blue)]">Relatório de Desempenho</h2>
            <div class="w-full md:w-1/2 mx-auto mb-8">
                <canvas id="performance-chart"></canvas>
            </div>
            <div id="review-section">
                <!-- A revisão dos erros será inserida aqui -->
            </div>
        </div>
    </div>

    <script>
    // DOCUMENTAÇÃO GERAL DO SCRIPT (JavaScript)

    // OBJETIVO:
    // Este script gerencia toda a lógica interativa do quiz de Direito Penal.
    // Suas principais responsabilidades são:
    // 1. Armazenar e renderizar as questões e alternativas.
    // 2. Processar as respostas do usuário, fornecendo feedback imediato.
    // 3. Habilitar a funcionalidade de "eliminar" alternativas.
    // 4. Gerar um relatório de desempenho visual com um gráfico e uma seção de revisão personalizada.
    // 5. Controlar a navegação suave pela sidebar.

    // ESTRUTURA DE DADOS:
    // - `questions`: Um array de objetos, onde cada objeto representa uma questão.
    //   - `question`: (string) O enunciado da questão.
    //   - `options`: (array de strings) As alternativas.
    //   - `answer`: (number) O índice da alternativa correta (base 0).
    //   - `explanation`: (string) A explicação detalhada da resposta correta, baseada no PDF.
    //   - `topic`: (string) O tópico principal abordado na questão, usado para a revisão.
    // - `userAnswers`: Um array para armazenar o estado de cada questão (respondida, correta/incorreta).

    const questions = [
        {
            question: "De acordo com o Art. 1º da Lei de Introdução ao Código Penal, qual é o critério legal utilizado para diferenciar crime de contravenção penal?",
            options: [
                "O grau de lesividade da conduta, sendo o crime considerado mais grave.",
                "A espécie de pena privativa de liberdade cominada, sendo reclusão ou detenção para crimes e prisão simples para contravenções.",
                "A possibilidade de aplicação de pena de multa, que é exclusiva das contravenções.",
                "A competência para julgamento, sendo a Justiça Federal para crimes e a Estadual para contravenções.",
                "A admissibilidade da modalidade tentada, que é permitida apenas nos crimes."
            ],
            answer: 1,
            explanation: "<strong>Comentário da Alternativa Correta (B):</strong> Conforme expressamente disposto no Art. 1º da Lei de Introdução ao Código Penal, o critério adotado pelo legislador é o da espécie de pena privativa de liberdade. A lei comina pena de <strong>reclusão ou de detenção</strong> para os crimes, enquanto para as <strong>contravenções</strong>, comina pena de <strong>prisão simples</strong> ou multa. As demais alternativas, embora possam apresentar outras distinções (como a tentativa ou a extraterritorialidade), não correspondem ao critério primário estabelecido no referido artigo. (Aula 15, p. 2)",
            topic: "Distinção entre Crime e Contravenção"
        },
        {
            question: "Sobre a natureza jurídica do porte de drogas para consumo pessoal (Art. 28 da Lei de Drogas), qual é a posição majoritária, defendida pelos Tribunais Superiores?",
            options: [
                "Ocorreu a descriminalização da conduta, que passou a ser um ilícito meramente administrativo.",
                "A conduta foi abolida do ordenamento jurídico (abolitio criminis).",
                "Ocorreu o fenômeno da despenalização, mantendo-se a natureza de crime, porém sem a previsão de pena privativa de liberdade.",
                "A conduta foi transformada em infração penal sui generis, não sendo nem crime nem contravenção.",
                "Ocorreu a descarcerização, que é sinônimo de descriminalização, tornando o fato atípico."
            ],
            answer: 2,
            explanation: "<strong>Comentário da Alternativa Correta (C):</strong> A corrente majoritária, adotada pelo STF e STJ, entende que o Art. 28 da Lei de Drogas promoveu a <strong>despenalização</strong> da conduta. Isso significa que, embora não haja mais a previsão de pena de prisão, a conduta <strong>continua sendo crime</strong>. A corrente minoritária defende a descriminalização. O termo 'descarcerização', embora usado por alguns doutrinadores, refere-se à ausência de pena de prisão, mas o termo técnico consolidado na jurisprudência para o fenômeno é 'despenalização'. (Aula 15, p. 3)",
            topic: "Natureza Jurídica do Art. 28 da Lei de Drogas"
        },
        {
            question: "No que tange à responsabilidade penal da pessoa jurídica por crimes ambientais, qual o entendimento atual do STF e do STJ sobre a teoria da dupla imputação?",
            options: [
                "A teoria é obrigatória, exigindo que a pessoa física (administrador) seja sempre processada junto com a pessoa jurídica.",
                "A teoria foi superada, sendo possível a responsabilização penal da pessoa jurídica independentemente da responsabilização da pessoa física que agiu em seu nome.",
                "A teoria só se aplica se o crime for praticado por uma empresa estatal.",
                "A teoria da dupla imputação nunca foi aceita no Brasil, sendo uma construção doutrinária estrangeira.",
                "A responsabilidade da pessoa jurídica é sempre subsidiária à da pessoa física."
            ],
            answer: 1,
            explanation: "<strong>Comentário da Alternativa Correta (B):</strong> Conforme o material, embora o STJ já tenha adotado a teoria da dupla imputação no passado, o entendimento atual, tanto do STJ quanto do STF, é de que ela <strong>não é mais exigida</strong>. Portanto, a pessoa jurídica pode ser responsabilizada por crimes ambientais (conforme Art. 225, § 3º, da CF) de forma autônoma, mesmo que não se consiga identificar ou processar a pessoa física que cometeu o ato em nome da empresa. (Aula 15, p. 6)",
            topic: "Responsabilidade Penal da Pessoa Jurídica e Dupla Imputação"
        },
        {
            question: "Quanto à classificação dos crimes segundo o sujeito ativo, assinale a alternativa que define corretamente um crime de mão própria.",
            options: [
                "É aquele que pode ser praticado por qualquer pessoa, não exigindo qualidade especial do agente.",
                "É aquele que exige uma qualidade especial do agente (ex: ser funcionário público), mas admite coautoria e participação.",
                "É aquele que, além de exigir uma qualidade especial, só pode ser executado pessoalmente pelo agente, admitindo apenas a participação.",
                "É sinônimo de crime próprio, diferenciando-se apenas na nomenclatura.",
                "É um crime que só pode ser praticado por pessoas jurídicas."
            ],
            answer: 2,
            explanation: "<strong>Comentário da Alternativa Correta (C):</strong> O crime de mão própria (ou de atuação pessoal) é o mais restritivo quanto ao sujeito ativo. Ele não apenas exige uma qualidade especial do agente, mas também que a conduta seja realizada <strong>pessoalmente por ele</strong>. Por essa razão, não se admite a coautoria (duas pessoas executando o verbo do tipo juntas), mas apenas a <strong>participação</strong> (alguém que induz, instiga ou auxilia o autor). O exemplo clássico é o falso testemunho. (Aula 15, p. 7)",
            topic: "Classificação dos Crimes (Comum, Próprio, Mão Própria)"
        },
        {
            question: "Considerando as distinções apresentadas no material entre crime e contravenção penal, qual das seguintes características é exclusiva da contravenção?",
            options: [
                "A ação penal pode ser pública ou privada.",
                "Admite a aplicação do princípio da extraterritorialidade.",
                "A competência para julgamento pode ser da Justiça Estadual ou Federal.",
                "A tentativa, em nenhuma hipótese, é punível.",
                "A pena privativa de liberdade pode ser de detenção."
            ],
            answer: 3,
            explanation: "<strong>Comentário da Alternativa Correta (D):</strong> O material de apoio apresenta um quadro comparativo claro. Uma das distinções fundamentais é que a <strong>tentativa não é punível</strong> no âmbito das contravenções penais, por força do art. 4º da Lei das Contravenções Penais. Já nos crimes, a tentativa é punível como regra. As demais opções descrevem características que ou pertencem aos crimes (extraterritorialidade, ação privada, competência federal) ou são incorretas. (Aula 15, p. 5)",
            topic: "Distinções Acessórias entre Crime e Contravenção"
        },
        {
            question: "O que se entende por sujeito passivo mediato (ou formal) da infração penal?",
            options: [
                "O titular do bem jurídico diretamente lesado pela conduta criminosa.",
                "A coletividade, nos casos de crimes vagos.",
                "A pessoa física ou jurídica que sofre o prejuízo material do crime.",
                "O Estado, como titular do interesse de punir (jus puniendi) e manter a ordem social.",
                "A família da vítima imediata."
            ],
            answer: 3,
            explanation: "<strong>Comentário da Alternativa Correta (D):</strong> A doutrina classifica o sujeito passivo em duas espécies. O sujeito passivo imediato (ou material) é o titular do bem jurídico diretamente atingido (ex: a pessoa que sofre o furto). Já o sujeito passivo <strong>mediato (ou formal)</strong> é sempre o <strong>Estado</strong>, pois toda infração penal, ao violar a norma, ofende o interesse estatal de manutenção da paz e da ordem jurídica. (Aula 15, p. 8)",
            topic: "Sujeito Passivo (Mediato e Imediato)"
        },
        {
            question: "Um crime que exige a qualidade de 'funcionário público' para ser praticado, como a corrupção passiva, e que admite coautoria e participação, é classificado como:",
            options: [
                "Crime comum.",
                "Crime de mão própria.",
                "Crime próprio.",
                "Crime vago.",
                "Crime de dano."
            ],
            answer: 2,
            explanation: "<strong>Comentário da Alternativa Correta (C):</strong> O <strong>crime próprio</strong> é aquele que exige uma qualidade ou condição especial do sujeito ativo. No exemplo, a condição é ser 'funcionário público'. Diferentemente do crime de mão própria, o crime próprio <strong>admite tanto coautoria quanto participação</strong>. Por exemplo, dois funcionários públicos podem praticar o crime em coautoria, ou um particular pode participar do crime de corrupção passiva praticado pelo funcionário. (Aula 15, p. 7)",
            topic: "Classificação dos Crimes (Comum, Próprio, Mão Própria)"
        },
        {
            question: "O crime de violação de sepultura (art. 210 do CP), que tem a coletividade como sujeito passivo, é um exemplo de:",
            options: [
                "Crime de mão própria.",
                "Crime próprio.",
                "Crime de mera conduta.",
                "Crime vago.",
                "Crime plurissubjetivo."
            ],
            answer: 3,
            explanation: "<strong>Comentário da Alternativa Correta (D):</strong> Conforme definido no material, <strong>crime vago</strong> é aquele que não possui um sujeito passivo determinado (pessoa física ou jurídica individualizada). Nesses casos, o bem jurídico tutelado pertence a toda a <strong>coletividade</strong>, que figura como sujeito passivo. O crime de violação de sepultura é o exemplo clássico citado na aula. (Aula 15, p. 8)",
            topic: "Crime Vago"
        },
        {
            question: "Sobre a recente decisão do STF (RE 635.659) a respeito do porte de drogas para consumo, é correto afirmar que:",
            options: [
                "Descriminalizou o porte de qualquer tipo de droga para uso pessoal, sem limite de quantidade.",
                "Fixou a tese de que não comete infração penal o porte para consumo pessoal da substância cannabis sativa, dentro de limites quantitativos específicos, reconhecendo apenas a ilicitude extrapenal.",
                "Transformou o porte de maconha em contravenção penal, punível com prisão simples.",
                "Decidiu que o Art. 28 da Lei de Drogas é inconstitucional em sua totalidade.",
                "Manteve o porte de maconha como crime, mas aplicou o fenômeno da despenalização para todas as drogas."
            ],
            answer: 1,
            explanation: "<strong>Comentário da Alternativa Correta (B):</strong> A decisão do STF foi específica e limitada. Ela estabeleceu que, para a substância <strong>cannabis sativa (maconha)</strong> e dentro dos limites fixados (40g ou 6 plantas-fêmeas), a conduta de portar para consumo pessoal <strong>não configura mais infração penal</strong>. Contudo, a Corte ressalvou a ilicitude extrapenal da conduta, mantendo sanções como advertência e medida educativa. A decisão não se estendeu a outras drogas nem declarou o artigo 28 totalmente inconstitucional. (Aula 15, p. 4)",
            topic: "Decisão do STF sobre Porte de Cannabis"
        },
        {
            question: "Qual é a principal distinção entre um crime próprio e um crime de mão própria?",
            options: [
                "O crime próprio exige qualidade especial do agente, enquanto o de mão própria não exige.",
                "O crime de mão própria não admite participação, enquanto o crime próprio admite.",
                "O crime próprio admite coautoria, enquanto o crime de mão própria, por sua natureza, não admite coautoria, apenas participação.",
                "Não há distinção, são termos sinônimos utilizados por diferentes correntes doutrinárias.",
                "O crime de mão própria só pode ser cometido por pessoa física, enquanto o crime próprio pode ser por pessoa jurídica."
            ],
            answer: 2,
            explanation: "<strong>Comentário da Alternativa Correta (C):</strong> A distinção central reside na executividade da conduta. Ambos exigem uma qualidade especial do agente. No entanto, o <strong>crime próprio</strong> pode ser executado por mais de um agente que possua a qualidade especial (<strong>admite coautoria</strong>). Já o <strong>crime de mão própria</strong> exige uma atuação personalíssima, indelegável, do autor; portanto, <strong>não admite coautoria</strong>, mas apenas a participação de um terceiro que instigue ou auxilie o autor a executar pessoalmente a conduta. (Aula 15, p. 7)",
            topic: "Classificação dos Crimes (Comum, Próprio, Mão Própria)"
        }
    ];

    const userAnswers = new Array(questions.length).fill(null);
    const quizContainer = document.getElementById('quiz-section');
    const reportSection = document.getElementById('report-section');
    let performanceChart = null;

    /**
     * Função para renderizar as questões na tela.
     * Itera sobre o array `questions` e cria o HTML para cada card de questão.
     * Adiciona os event listeners para as opções e para os ícones de "tesoura".
     */
    function renderQuestions() {
        let quizHTML = '';
        questions.forEach((q, index) => {
            quizHTML += `
                <div class="question-card" id="question-${index}">
                    <p class="question-title">${index + 1}. ${q.question}</p>
                    <div class="options-container">
            `;
            q.options.forEach((option, optionIndex) => {
                quizHTML += `
                    <div class="option" data-question="${index}" data-option="${optionIndex}">
                        <span class="option-letter">${String.fromCharCode(65 + optionIndex)}</span>
                        <span class="option-text">${option}</span>
                        <i class="fas fa-cut scissor-icon" title="Eliminar alternativa"></i>
                    </div>
                `;
            });
            quizHTML += `
                    </div>
                    <div class="feedback" id="feedback-${index}"></div>
                </div>
            `;
        });
        quizContainer.innerHTML = quizHTML;
        addEventListeners();
    }

    /**
     * Adiciona os event listeners a todas as alternativas e ícones de tesoura.
     * Esta função é chamada após a renderização das questões.
     */
    function addEventListeners() {
        document.querySelectorAll('.option').forEach(option => {
            option.addEventListener('click', handleOptionSelect);
        });
        document.querySelectorAll('.scissor-icon').forEach(icon => {
            icon.addEventListener('click', handleEliminateOption);
        });
    }

    /**
     * Lida com o clique para eliminar uma alternativa.
     * @param {Event} e - O objeto do evento de clique.
     */
    function handleEliminateOption(e) {
        e.stopPropagation(); // Impede que o clique no ícone selecione a alternativa.
        const optionDiv = e.target.parentElement;
        if (!optionDiv.classList.contains('eliminated') && userAnswers[optionDiv.dataset.question] === null) {
            optionDiv.classList.add('eliminated');
        }
    }

    /**
     * Lida com a seleção de uma alternativa pelo usuário.
     * @param {Event} e - O objeto do evento de clique.
     */
    function handleOptionSelect(e) {
        const selectedOption = e.currentTarget;
        const questionIndex = parseInt(selectedOption.dataset.question);
        const optionIndex = parseInt(selectedOption.dataset.option);

        // Impede nova resposta se a questão já foi respondida ou se a opção foi eliminada.
        if (userAnswers[questionIndex] !== null || selectedOption.classList.contains('eliminated')) {
            return;
        }

        const isCorrect = optionIndex === questions[questionIndex].answer;
        userAnswers[questionIndex] = { answered: optionIndex, correct: isCorrect };

        // Remove a classe 'selected' de qualquer outra opção na mesma questão.
        const optionsContainer = selectedOption.parentElement;
        optionsContainer.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));

        // Adiciona a classe de feedback (correta ou incorreta).
        selectedOption.classList.add(isCorrect ? 'correct' : 'incorrect');
        
        // Desabilita os outros botões de eliminar
        optionsContainer.querySelectorAll('.scissor-icon').forEach(icon => icon.style.display = 'none');

        // Mostra o feedback detalhado.
        showFeedback(questionIndex, isCorrect);
        
        // Verifica se todas as questões foram respondidas para gerar o relatório.
        if (userAnswers.every(answer => answer !== null)) {
            reportSection.classList.remove('hidden');
            generateReport();
            scrollToSection('report-section');
        }
    }

    /**
     * Exibe o feedback (explicação) abaixo da questão.
     * @param {number} questionIndex - O índice da questão.
     * @param {boolean} isCorrect - Se a resposta foi correta.
     */
    function showFeedback(questionIndex, isCorrect) {
        const feedbackDiv = document.getElementById(`feedback-${questionIndex}`);
        const questionData = questions[questionIndex];
        
        let feedbackHTML = `
            <p class="feedback-title">${isCorrect ? 'Resposta Correta!' : 'Resposta Incorreta.'}</p>
            <p>${questionData.explanation}</p>
        `;
        
        feedbackDiv.innerHTML = feedbackHTML;
        feedbackDiv.className = `feedback ${isCorrect ? 'correct' : 'incorrect'}`;
    }
    
    /**
     * Gera o relatório final com o gráfico e a seção de revisão.
     */
    function generateReport() {
        const correctAnswers = userAnswers.filter(a => a.correct).length;
        const incorrectAnswers = questions.length - correctAnswers;

        // Renderiza o gráfico
        const ctx = document.getElementById('performance-chart').getContext('2d');
        if (performanceChart) {
            performanceChart.destroy();
        }
        performanceChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Acertos', 'Erros'],
                datasets: [{
                    data: [correctAnswers, incorrectAnswers],
                    backgroundColor: ['var(--success-green)', 'var(--error-red)'],
                    borderColor: ['var(--white)'],
                    borderWidth: 4
                }]
            },
            options: {
                responsive: true,
                cutout: '70%',
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            font: { size: 14 },
                            padding: 20
                        }
                    },
                    title: {
                        display: true,
                        text: 'Seu Desempenho Geral',
                        font: { size: 18, weight: 'bold' },
                        padding: { bottom: 20 }
                    }
                }
            }
        });

        // Gera a seção de revisão para os erros
        const reviewSection = document.getElementById('review-section');
        let reviewHTML = `<h3 class="text-xl font-bold mb-4 text-[var(--primary-blue)]">Pontos para Revisão</h3>`;
        const incorrectQuestions = userAnswers
            .map((answer, index) => ({...answer, index}))
            .filter(answer => !answer.correct);

        if (incorrectQuestions.length === 0) {
            reviewHTML += `<p class="text-lg text-[var(--success-green)] font-semibold">Parabéns! Você acertou todas as questões. Continue com o excelente trabalho!</p>`;
        } else {
            reviewHTML += `<p class="mb-4 text-[var(--dark-gray)]">Você errou ${incorrectQuestions.length} questão(ões). Foque nestes tópicos para solidificar seu conhecimento:</p>`;
            incorrectQuestions.forEach(q => {
                const originalQuestion = questions[q.index];
                reviewHTML += `
                    <div class="review-card">
                        <h4 class="font-bold text-lg mb-2 text-[#D97706]">${originalQuestion.topic}</h4>
                        <p class="mb-3"><strong>Na questão:</strong> "${originalQuestion.question}"</p>
                        <p class="font-semibold">Relembre o ponto-chave:</p>
                        ${originalQuestion.explanation}
                    </div>
                `;
            });
        }
        reviewSection.innerHTML = reviewHTML;
    }

    /**
     * Função para rolar a página suavemente até uma seção específica.
     * @param {string} sectionId - O ID do elemento para o qual rolar.
     */
    function scrollToSection(sectionId) {
        document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
    }

    // Função para atualizar o link ativo na sidebar com base no scroll
    window.addEventListener('scroll', () => {
        const sections = ['quiz-section', 'report-section'];
        let currentSection = '';

        sections.forEach(sectionId => {
            const section = document.getElementById(sectionId);
            if (section) {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 150 && rect.bottom >= 150) {
                    currentSection = sectionId;
                }
            }
        });
        
        const sidebarLinks = document.querySelectorAll('#sidebar ul li a');
        sidebarLinks.forEach(link => {
            link.classList.remove('active');
            if(link.getAttribute('href') === `#${currentSection}`) {
                link.classList.add('active');
            }
        });
    });

    // Inicia a renderização das questões quando a página carrega.
    document.addEventListener('DOMContentLoaded', renderQuestions);
    </script>

</body>
</html>
